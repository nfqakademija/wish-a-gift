{% extends 'base.html.twig' %}

{% block title %}Homepage - {{ parent() }}{% endblock %}
{% block stylesheets %}
  <link href="https://fonts.googleapis.com/css?family=Lato:100" rel="stylesheet" type="text/css">
  <link href="https://fonts.googleapis.com/css?family=Pacifico" rel="stylesheet" type="text/css">
  {{ parent() }}
{% endblock %}

{% block javascripts %}
  {{ parent() }}

  <script>
      $(document).ready(function () {
          console.log("All resources finished loading");

          // add click handler for "Add" button
          $('#addButton').click(function () {
              addGift($('#gift'), $('#giftList'));
          });

      });

      function addGift(gift, giftList) {
          console.log(gift, giftList);

          giftList = giftList.append('<div class="input-group mb-3" id="giftItem">\n' +
              `<input type="text" class="form-control" readonly value="${escapeHtml(gift.val())}" />\n` +
              '<div class="input-group-append">\n' +
              '<button type="button" class="btn btn-outline btn-success deleteButton" id="deleteButton">x</button>\n' +
              '</div>\n' +
              '</div>');
      }

      function escapeHtml(string) {
          return (string.replace(/&/g, "&amp;")
              .replace(/</g, "&lt;")
              .replace(/>/g, "&gt;")
              .replace(/"/g, "&quot;")
              .replace(/'/g, "&#039;"));
      }

      //clear input field on button click
      $('input:text').click(
          function(){
              $(this).val('');
          });

  </script>
{% endblock %}

{% block body %}
  <div class="">

    <div class="modal-header">
      <h1 class="modal-title" id="modalTitle">Create a Wish List</h1>
    </div>

    <div class="container-fluid">
        {{ form_start(form, {
          'attr': {
            'id': 'createForm'
          }} )
        }}
        <div id="identificationForm" class="identificationForm">
          <div class="form-group row">
            {{ form_label(form.FirstName, 'Name', {'for': 'name', 'label_attr': {'class': 'col-sm-2 col-form-label'}}) }}
            <div class="col-sm-10">
              {{ form_widget(form.FirstName, {
                'attr': {
                  'class': 'form-control',
                  'placeholder': 'Enter your name'
                }} )
              }}
            </div>
          </div>
          <div class="form-group row">
            {{ form_label(form.LastName, 'Surname', {'for': 'surname', 'label_attr': {'class': 'col-sm-2 col-form-label'}}) }}
            <div class="col-sm-10">
              {{ form_widget(form.LastName, {
                'attr': {
                  'class': 'form-control',
                  'placeholder': 'Enter your surname'
                }})
              }}
            </div>
          </div>
          <div class="form-group row">
            {{ form_label(form.Email, 'Email', {'for': 'email', 'label_attr': {'class': 'col-sm-2 col-form-label'}}) }}
            <div class="col-sm-10">
              {{ form_widget(form.Email, {
                'attr': {
                  'class': 'form-control',
                  'placeholder': 'Enter your email',
                  'aria-describedby': 'emailHelp'
                }})
              }}
            </div>
          </div>
        </div>

        <div>
          <div class="form-group row">
            {{ form_label(form.Title, 'WishList Title', {'for': 'title', 'label_attr': {'class': 'col-sm-2 col-form-label'}}) }}
            <div class="col-sm-10">
              {{ form_widget(form.Title, {
                'attr': {
                  'class': 'form-control',
                  'placeholder': 'Type the title for your list'
                }})
              }}
            </div>
          </div>

          <div class="form-group">
            {{ form_label(form.Description, 'Description', {'for': 'description'}) }}
            {{ form_widget(form.Description, {
              'attr': {
                'class': 'form-control',
                'row': "3"
              }})
            }}
          </div>

          <div class="input-group mb-3">
            {{ form_widget(form.Gift.Gift, {
              'attr': {
                'class': 'form-control',
                'placeholder': 'Write your wish here'
              }})
            }}
            <div class="input-group-append">
              <button class="btn btn-outline btn-success addButton" id="addButton" type="button">Add a Gift
              </button>
            </div>
          </div>

          <div id="giftList"></div>

        </div>

        {{ form_widget(form.Save, {
          'attr': {
            'class': 'btn btn-success btn-md btn-block saveButton'
          }})
        }}

        <button type="button" class="btn btn-success btn-md btn-block"
                onclick="location.href='{{ path('secondPage') }}'">Share with Friends
        </button>
        {{ form_end(form) }}
    </div>

  </div>

  <div class="modal-footer">
    <div class="container-fluid">
      <div class="input-group mb-3">
        <input type="text" class="form-control" name="title" placeholder="Link to your WishList"/>
        <div class="input-group-append">
          <button type="button" class="btn btn-success" onclick="">Copy</button>
        </div>
      </div>
    </div>
  </div>
{% endblock %}
